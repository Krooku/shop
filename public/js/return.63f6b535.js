(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["return"],{"7b8c":function(t,e,r){},baea:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("form",{staticClass:"form-container",attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.endErrand(e)}}},[a("input-label",{attrs:{"label-text":"Miejsce zwrotu",maxlength:32},model:{value:t.returnCar.place,callback:function(e){t.$set(t.returnCar,"place",e)},expression:"returnCar.place"}}),a("div",{staticClass:"date-box"},[a("span",{staticClass:"content-name"},[t._v(" Data zwrotu ")]),a("date-picker",{staticClass:"date",attrs:{"value-type":"format",placeholder:t.returnCar.realDate,required:!0},model:{value:t.returnCar.realDate,callback:function(e){t.$set(t.returnCar,"realDate",e)},expression:"returnCar.realDate"}})],1),a("div",{staticClass:"date-box"},[a("span",{staticClass:"content-name"},[t._v(" Godzina zwrotu ")]),a("date-picker",{staticClass:"date",attrs:{"minute-step":1,"hour-options":t.hours,format:"HH:mm","value-type":"format",type:"time",placeholder:t.returnTime,required:!0},model:{value:t.returnTime,callback:function(e){t.returnTime=e},expression:"returnTime"}})],1),a("input-label",{attrs:{"label-text":"Km przyjazdowe","is-text":!1},model:{value:t.returnCar.mileage,callback:function(e){t.$set(t.returnCar,"mileage",e)},expression:"returnCar.mileage"}}),a("input-label",{attrs:{"label-text":"Stan paliwa",max:100,"is-text":!1},model:{value:t.returnCar.fuel,callback:function(e){t.$set(t.returnCar,"fuel",e)},expression:"returnCar.fuel"}}),a("div",{staticClass:"radio-input"},[a("p",{staticClass:"content-name"},[t._v(" Czystość auta ")]),a("div",{staticClass:"input-container"},[a("div",{staticClass:"input-label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.isClearAfter,expression:"isClearAfter"}],attrs:{type:"radio",value:"true"},domProps:{checked:t._q(t.isClearAfter,"true")},on:{change:function(e){t.isClearAfter="true"}}}),a("label",{attrs:{for:"true"}},[t._v("Czyste")])]),a("div",{staticClass:"input-label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.isClearAfter,expression:"isClearAfter"}],attrs:{type:"radio",value:"false"},domProps:{checked:t._q(t.isClearAfter,"false")},on:{change:function(e){t.isClearAfter="false"}}}),a("label",{attrs:{for:"false"}},[t._v("Brudne")])])])]),a("input-label",{attrs:{"label-text":"Uwagi",maxlength:128},model:{value:t.returnCar.comments,callback:function(e){t.$set(t.returnCar,"comments",e)},expression:"returnCar.comments"}}),a("p",[t._v(" Podpis klienta ")]),a("VueSignaturePad",{ref:"signaturePad",attrs:{id:"signature",width:"300px",height:"300px",options:t.options}}),a("button",{staticClass:"btn",attrs:{type:"button"},on:{click:t.undo}},[t._v(" Wyczyść podpis ")]),a("canvas",{attrs:{id:"myCanvas",width:"300",height:"227",onLoad:t.drawFrom},on:{mousemove:t.showCoordinates,mousedown:t.drawScratch}}),a("div",{staticStyle:{display:"none"}},[a("img",{attrs:{id:"source",src:r("ea1c"),width:"300",height:"227"},on:{load:t.onImgLoad}})]),a("button",{staticClass:"btn",attrs:{type:"submit"}},[t._v(" Zwróć ")]),a("router-link",{attrs:{to:{name:"rentalcontract",params:{errandId:t.errandId}}}},[a("button",{staticClass:"btn",attrs:{type:"submit"}},[t._v(" Umowa najmu ")])])],1)])},n=[],s=r("a34a"),i=r.n(s),o=r("d722"),u=r("ec45"),c=(r("411c"),r("448b"));function l(t,e,r,a,n,s,i){try{var o=t[s](i),u=o.value}catch(c){return void r(c)}o.done?e(u):Promise.resolve(u).then(a,n)}function h(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var s=t.apply(e,r);function i(t){l(s,a,n,i,o,"next",t)}function o(t){l(s,a,n,i,o,"throw",t)}i(void 0)}))}}var d={components:{DatePicker:u["a"],InputLabel:c["a"]},data:function(){return{errandId:this.$route.params.errandId,time1:"",time2:"",message:"none",error:!1,editModal:!1,returnTime:null,currentCanvas:null,x:0,y:0,scratchs:[],isClearAfter:!0,returnCar:{place:"",realDate:null,mileage:null,fuel:100,deposit:null,depositSignature:"pracownik",scratchs:[],signature:""}}},beforeRouteEnter:function(){var t=h(i.a.mark((function t(e,r,a){var n;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["a"].getErrand(e.params.errandId);case 2:if(n=t.sent,200===n.status){t.next=5;break}return t.abrupt("return",a({name:"homepage"}));case 5:a((function(t){t.scratchs=n.data.rent.scratchs}));case 6:case"end":return t.stop()}}),t)})));function e(e,r,a){return t.apply(this,arguments)}return e}(),computed:{getRole:function(){return this.$store.getters.role}},mounted:function(){var t=h(i.a.mark((function t(){return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.returnCar.realDate=this.formatDate(),this.returnTime=this.formatTime(),this.deposit=new Date;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{endErrand:function(){var t=h(i.a.mark((function t(){var e,r,a;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.save()){t.next=2;break}return t.abrupt("return");case 2:return e=this.returnTime.split(":"),r=new Date(this.returnCar.realDate),r.setHours(e[0]),r.setMinutes(e[1]),this.returnCar.realDate=r,alert(this.$store.getters.username),t.next=10,o["a"].endErrand(this.errandId,{returnCar:this.returnCar,employeePickedUp:this.$store.getters.username,isClearAfter:this.isClearAfter});case 10:a=t.sent,200!==a.status?(this.error=!0,this.message=a.data.message):(this.error=!1,this.message="auto zostało zwrócone",this.$router.push({name:"rentalcontract",params:{errandId:this.errandId}})),alert(this.message);case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),formatDate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=new Date;e.setDate(e.getDate()+t);var r=""+(e.getMonth()+1),a=""+e.getDate(),n=e.getFullYear();return r.length<2&&(r="0"+r),a.length<2&&(a="0"+a),[n,r,a].join("-")},formatTime:function(){var t=new Date;t.setDate(t.getDate());var e="",r=t.getHours(),a=t.getMinutes();return e+=r<10?"0"+r+":":r+":",e+=a<10?"0"+a:a,e},undo:function(){while(!this.$refs.signaturePad.isEmpty())this.$refs.signaturePad.undoSignature()},save:function(){var t=this.$refs.signaturePad.saveSignature(),e=t.isEmpty,r=t.data;return e?(this.message="Wymagany podpis klienta",this.error=!0):this.returnCar.signature=r,e},onImgLoad:function(){var t=document.getElementById("myCanvas");this.currentCanvas=t;var e=document.getElementById("source"),r=Math.min(t.width/e.width,t.height/e.height);t.getContext("2d").drawImage(e,0,0,e.width*r,e.height*r),this.drawFrom()},drawFrom:function(){for(var t=0;t<this.scratchs.length;t++)this.drawX(this.currentCanvas.getContext("2d"),this.scratchs[t].x,this.scratchs[t].y,"red");for(var e=0;e<this.returnCar.scratchs.length;e++)this.drawX(this.currentCanvas.getContext("2d"),this.returnCar.scratchs[e].x,this.returnCar.scratchs[e].y,"green")},drawX:function(t,e,r,a){t.beginPath(),t.strokeStyle=a,t.lineWidth=4,t.moveTo(e,r),t.lineTo(e+4,r+4),t.lineTo(e-4,r-4),t.moveTo(e,r),t.lineTo(e+4,r-4),t.lineTo(e-4,r+4),t.stroke(),t.closePath()},showCoordinates:function(t){this.x=t.offsetX,this.y=t.offsetY},drawScratch:function(t){this.checkCollision()&&(this.returnCar.scratchs.push({x:this.x,y:this.y}),this.drawX(this.currentCanvas.getContext("2d"),this.x,this.y,"green"))},checkCollision:function(){for(var t=0;t<this.returnCar.scratchs.length;t++)if(this.x<=this.returnCar.scratchs[t].x+12&&this.x>=this.returnCar.scratchs[t].x-12&&this.y<=this.returnCar.scratchs[t].y+12&&this.y>=this.returnCar.scratchs[t].y-12)return this.currentCanvas.getContext("2d").clearRect(0,0,this.currentCanvas.width,this.currentCanvas.height),this.returnCar.scratchs.splice(t,1),this.onImgLoad(),!1;for(var e=0;e<this.scratchs.length;e++)if(this.x<=this.scratchs[e].x+12&&this.x>=this.scratchs[e].x-12&&this.y<=this.scratchs[e].y+12&&this.y>=this.scratchs[e].y-12)return!1;return!0}}},m=d,p=(r("e238"),r("2877")),f=Object(p["a"])(m,a,n,!1,null,null,null);e["default"]=f.exports},e238:function(t,e,r){"use strict";var a=r("7b8c"),n=r.n(a);n.a},ea1c:function(t,e,r){t.exports=r.p+"img/stan_techniczny.a49917d6.jpg"}}]);